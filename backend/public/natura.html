<!-- natura.html -->

<!-- TODO: Adicionar suporte à múltiplos arquivos -->
<!-- TODO: Adicionar informação do arquivo selecionado -->

<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>MCZ Express - Importar Franchise Report</title>
    <link rel="stylesheet" href="css/style.css" />
    <script src="js/scripts.js" defer></script>
  </head>
  <body>
    <form action="/upload-report" method="post" enctype="multipart/form-data">
      <div>
        <h3>Insira os arquivos do Franchise Report para importação:</h3>
      </div>
      <label for="xlsxInput">Escolher arquivo XLSX</label>
      <input
        type="file"
        name="xlsx_file"
        id="xlsxInput"
        accept=".xlsx"
        required
      />
      <button type="submit">Processar Relatório</button>
      <div id="fileListContainer">
        <p id="fileListTitle">Arquivo selecionado:</p>
        <div id="fileList"></div>
      </div>
    </form>

    <script>
      document
        .getElementById("xlsxInput")
        .addEventListener("change", function (event) {
          const fileListDiv = document.getElementById("fileList");
          fileListDiv.innerHTML = "";

          Array.from(event.target.files).forEach((file) => {
            const fileNameParagraph = document.createElement("p");
            fileNameParagraph.textContent = file.name;
            fileNameParagraph.style.textAlign = "center"; // Adiciona o alinhamento ao centro
            fileListDiv.appendChild(fileNameParagraph);
          });
        });
    </script>
    <script>
      adicionarDados("pdfInput");
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
    <script src="js/scripts.js"></script>
  </body>
<a href="/natura/files/Triagem%20NATURA%20-%20TEMP.xlsx">Baixar planilha natura</a>
<a href="/natura/files/eda50-ota-207.01.00.0023.zip">Baixar apk Excel</a>
</html>
